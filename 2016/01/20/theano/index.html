<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theano Quick Intro &mdash; Vict0rsch</title>
    
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    
    <link href="https://fonts.googleapis.com/css?family=Nunito:400,700" rel="stylesheet" type="text/css">
    <!-- <link rel="stylesheet" href="/assets/main.css"> -->

    <link rel="stylesheet" type="text/css" href="/assets/main-52ae7e3dfe5a5913b1a1f11b64d5f74b05fbe724da7d42f261065884084029ab.css" integrity="sha256-Uq5+Pf5aWROxofEbZNX3SwX75yTafULyYQZYhAhAKas=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="/assets/tingle-141cb380cbc51d7fad4249751d1e3cffb07ccff80f6b0836164a30c2b857bf2a.css" integrity="sha256-FByzgMvFHX+tQkl1HR48/7B8z/gPawg2FkowwrhXvyo=" crossorigin="anonymous">
    <!-- <link rel="stylesheet" href="/assets/tingle.css"> -->

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/images/light-bulb.svg" />
    <!--rss-feed <link href="/feed.xml" rel="alternate" type="application/rss+xml" title="Vict0rsch" /> -->
    <meta name="title" content="Theano Quick Intro ">
    <link rel="canonical" href="https://vict0rs.ch/2016/01/20/theano/">
    
    
    <meta property="og:title" content="Theano Quick Intro " />
    <meta property="og:url" content="https://vict0rs.ch/2016/01/20/theano/" />
    
    
    <meta property="og:description" content="Theano and Tensorflow don't handle computations as others do. They are millenials so they feel the need to be special." />
    <meta name="description" content="Theano and Tensorflow don't handle computations as others do. They are millenials so they feel the need to be special." />
    
    <meta property="og:site_name" content="Vict0rsch">
    
    <!--google analytics tracking code here-->
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

 ga('create', 'UA-88678459-1', 'auto');
 ga('send', 'pageview');
 
 console.log('gogol analytics')
</script>

    
    <script src="https://unpkg.com/nprogress@0.2.0/nprogress.js"></script>
<style>
#nprogress{pointer-events:none}#nprogress .bar{background:#2077b2;position:fixed;z-index:1031;top:0;left:0;width:100%;height:3px}#nprogress .peg{display:block;position:absolute;right:0;width:100px;height:100%;box-shadow:0 0 10px #2077b2,0 0 5px #2077b2;opacity:1;-webkit-transform:rotate(3deg) translate(0px,-4px);-ms-transform:rotate(3deg) translate(0px,-4px);transform:rotate(3deg) translate(0px,-4px)}#nprogress .spinner{display:block;position:fixed;z-index:1031;top:15px;right:15px}#nprogress .spinner-icon{width:18px;height:18px;box-sizing:border-box;border:solid 2px transparent;border-top-color:#2077b2;border-left-color:#2077b2;border-radius:50%;-webkit-animation:nprogress-spinner 400ms linear infinite;animation:nprogress-spinner 400ms linear infinite}.nprogress-custom-parent{overflow:hidden;position:relative}.nprogress-custom-parent #nprogress .spinner,.nprogress-custom-parent #nprogress .bar{position:absolute}@-webkit-keyframes nprogress-spinner{0%{-webkit-transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg)}}@keyframes nprogress-spinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
</style>

</head>

<body>
    <script>
        NProgress.configure({
            easing: 'ease',
            speed: 600,
            showSpinner: false,
        });
        NProgress.start();
        var int = setInterval(()=> {
            NProgress.inc()
        }, 500)
        window.onload = function(){
            clearInterval(int);
            NProgress.done();
        };
    </script>

    <div id='wrapper'>
        <div id='main'>
            <section id="navbar" class="site-nav">
                <header>
                    <nav id="navigation">
                        <a class="brand" href="/">
                            <img src="/images/light-bulb.svg" alt="Home"><span class="hidable-nav">Home</span>
                        </a>
                        
                        <a href="/resources">Resources</a>
                        
                        <a href="/about">About</a>
                        
                        
                        <a href="#" class='search-link'>
                                <span class="hidable-nav">Search</span> <i class="fa fa-search"></i>
                        </a>
                        
                    </nav>
                    <nav class="tagline">
                        <span>Learn Keras and Lasagne (2015)</span>
                        <a href="/tutorials" class="btn btn-outline">Tutorials</a>
                    </nav>
                </header>
            </section>

            
<article>
    <div class="container">
        <header>
            
            <div class="meta">
                <span class='meta_text'>By</span> <address><a rel="author" href="" title="Victor Schmidt"
                        target="_blank">Victor Schmidt</a></address> <span class='meta_text'>&mdash;
                    <time pubdate datetime="2016-20-January" title="January 20, 2016">January 20, 2016</time></span>
            </div>
            
            <h1 class="title">Theano Quick Intro</h1><span id='title_buttons'><a id='night_mode' class="btn btn-outline dark">Read
                    in the dark</a></span>
            <h2 class="subtitle">Getting familair with the computation graph</h2>
        </header>

        <section>
            <div id='post-content'>
                <h5 id="tensorflow-is-very-close-to-theano-on-this-matter-so-getting-one-helps-a-lot-for-the-other">Tensorflow is very close to Theano on this matter so getting one helps a lot for the other</h5>

<p><a href="http://deeplearning.net/software/theano/">See Theano’s presentation</a></p>

<blockquote>
  <p>Theano is a Python library that allows you to define, optimize, and evaluate mathematical expressions involving multi-dimensional arrays efficiently. Theano features:</p>

  <ul>
    <li>tight integration with NumPy – Use numpy.ndarray in Theano-compiled functions.</li>
    <li>transparent use of a GPU – Perform data-intensive calculations up to 140x faster than with CPU.(float32 only)</li>
    <li>efficient symbolic differentiation – Theano does your derivatives for function with one or many inputs.</li>
    <li>speed and stability optimizations – Get the right answer for log(1+x) even when x is really tiny.
dynamic C code generation – Evaluate expressions faster.</li>
    <li>extensive unit-testing and self-verification – Detect and diagnose many types of mistake.</li>
  </ul>

  <p>Theano has been powering large-scale computationally intensive scientific investigations since 2007. But it is also approachable enough to be used in the classroom (IFT6266 at the University of Montreal).</p>
</blockquote>

<p>Regarding our purpose here, Theano’s main features to remember are:</p>

<ul>
  <li>Its graph structure</li>
  <li>How it handles functions</li>
  <li>Variables</li>
</ul>

<h2 id="theanos-graph">Theano’s graph</h2>

<p><a href="http://deeplearning.net/software/theano/extending/graphstructures.html#graphstructures">Theano’s Symbolic Graph</a></p>

<p>I <strong>strongly</strong> recommend you spend the time you need to understand the explanation from the link above. However here is a very short summary.</p>

<p>Basically Theano’s way of computing is just like when you try and solve a physics or maths problem : you write equations, you define quantities that you re-use in further equations and <em>then</em> you apply numbers to your results.</p>

<p>Let’s take an example : say you define a variable <code class="language-plaintext highlighter-rouge">x</code>. Then you define a quantity <code class="language-plaintext highlighter-rouge">y = x^2</code>. Lastly say you want to evaluate <code class="language-plaintext highlighter-rouge">y - x^2</code>. You do know it will be zero. So does Theano. It does not need numbers to compute a mathematical expression.</p>

<p>This is the <strong>graph</strong>’s idea: variables are propagated so that Theano knows their interdependancies and then it applies numeric values to the variables.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">theano.tensor</span> <span class="k">as</span> <span class="n">T</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">T</span><span class="p">.</span><span class="n">dmatrix</span><span class="p">(</span><span class="s">'x'</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">T</span><span class="p">.</span><span class="n">dmatrix</span><span class="p">(</span><span class="s">'y'</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span></code></pre></figure>

<p><img src="http://deeplearning.net/software/theano/_images/apply1.png" alt="Theano graph illustration" /></p>

<p>In this code example (from <a href="http://deeplearning.net/software/theano/extending/graphstructures.html#graphstructures">Theano’s Symbolic Graph</a>), <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code> are declared variables, they are going to be used afterwards. Then <code class="language-plaintext highlighter-rouge">z</code> is defined as an expression depending on <code class="language-plaintext highlighter-rouge">x</code>and <code class="language-plaintext highlighter-rouge">y</code>. Theano generates the above graph to link variables and operations together.</p>

<p>To evaluate <code class="language-plaintext highlighter-rouge">z</code> on numerical values of <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code> (say 4 and 1 for instance), you will need functions.</p>

<h2 id="theano-functions">Theano functions</h2>

<p><a href="http://deeplearning.net/software/theano/library/compile/function.html">Theano’s function documentation</a><br />
<a href="http://deeplearning.net/software/theano/tutorial/examples.html">Function examples</a></p>

<p>Once again, I can not underline enough the need to go deeply into the above documentation. But once again, here is a short summary ob the <strong>basics</strong>…</p>

<p>As mentionned above, functions in Theano are the equivalent of a numerical application : they come last after the definition of variables, operations and expressions. When the Python interpreter comes to the line <code class="language-plaintext highlighter-rouge">foo = theano.function(...)</code>, it creates the graph linking variables. This is the <strong>compilation</strong> time. Then the function can be called on numeric values.</p>

<p>Here is the example adapted from <a href="http://deeplearning.net/software/theano/tutorial/examples.html">Function examples</a></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">theano</span>
<span class="kn">import</span> <span class="nn">theano.tensor</span> <span class="k">as</span> <span class="n">T</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">T</span><span class="p">.</span><span class="n">dmatrix</span><span class="p">(</span><span class="s">'x'</span><span class="p">)</span>
<span class="n">sigmoid</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">T</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
<span class="n">logistic</span> <span class="o">=</span> <span class="n">theano</span><span class="p">.</span><span class="n">function</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">sigmoid</span><span class="p">)</span>
<span class="n">example</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]]</span>
<span class="n">logistic</span><span class="p">(</span><span class="n">example</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">array</span><span class="p">([[</span> <span class="mf">0.5</span>       <span class="p">,</span>  <span class="mf">0.73105858</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.26894142</span><span class="p">,</span>  <span class="mf">0.11920292</span><span class="p">]])</span></code></pre></figure>

<p>So here we declare a Theano variable <code class="language-plaintext highlighter-rouge">x</code>. Then we define another variable, <code class="language-plaintext highlighter-rouge">sigmoid</code>, as an expression of <code class="language-plaintext highlighter-rouge">x</code>. We then declare the Theano function <code class="language-plaintext highlighter-rouge">logistic</code>, that compiles and optimizes the execution graph linking <code class="language-plaintext highlighter-rouge">sigmoid</code> and <code class="language-plaintext highlighter-rouge">x</code>. Finaly we give <code class="language-plaintext highlighter-rouge">logistic</code> a numerical application using <code class="language-plaintext highlighter-rouge">example</code>.</p>

<p>Theano functions are way richer than that so I suggest you go and look at least into <strong><a href="http://deeplearning.net/software/theano/tutorial/examples.html#setting-a-default-value-for-an-argument">Params</a></strong>, <strong><a href="http://deeplearning.net/software/theano/tutorial/examples.html#using-shared-variables">Shared Variables</a></strong> and  <strong>Updates</strong> (4th paragraph in <a href="http://deeplearning.net/software/theano/tutorial/examples.html#using-shared-variables">Shared Variables</a>) (not knowing about Shared Variables is missing a huge part of how Theano works and they are needed for Lasagne).</p>

<h2 id="variables">Variables</h2>

<p><a href="http://deeplearning.net/software/theano/library/tensor/basic.html#all-fully-typed-constructors">All fully typed constructors</a></p>

<p>As seen before, there are variables and shared variables in Theano. Also, Theano uses a new kind of equivalent to Numpy’s <code class="language-plaintext highlighter-rouge">ndarray</code> : Tensors. These are strongly typed. You can find in the above link all the tensor types you can use but be aware that the nomenclature is based both on dimensionnality and type.</p>

<blockquote>
  <p>Theano provides a list of predefined tensor types that can be used to create a tensor variables. Variables can be named to facilitate debugging, and all of these constructors accept an optional name argument.</p>
</blockquote>

<h2 id="warning">Warning</h2>
<p>Debugging Theano errors can be quite difficult. I suggest you go through <a href="http://deeplearning.net/software/theano/tutorial/debug_faq.html">this</a> if you have troubles.</p>

<p>You can set <code class="language-plaintext highlighter-rouge">exception_verbosity = high</code> in your <code class="language-plaintext highlighter-rouge">~/.theanorc</code> file, but it can make the errors <em>really</em> verbose.</p>

<p>Also, if you do not understand why printing your variables to check their values with standard <code class="language-plaintext highlighter-rouge">print</code> does not help, you are not ready to go on with Theano (but who said Keras needed that much Theano?).</p>


            </div>
            
<div class="social">
    
    <div class='custom_twitter_share'>
        <a href="https://twitter.com/share" class="twitter-share-button"  data-text="Theano Quick Intro" data-related="vict0rsch">Tweet</a>
    </div>
    
    
    <div class='custom_fb_share'>
        <div class="fb-like" data-width="150" data-layout="button_count" data-action="like" data-show-faces="true" data-send="false"></div>
    </div>
    
    
    
    
</div>

        </section>

        <footer>
            <address>
                
                <p>
                    Written by <strong><a rel="author" href="https://twitter.com/vict0rsch" title=""
                            target="_blank">Victor Schmidt</a></strong>
                    <span class="muted"></span>
                    
                    &nbsp;- <iframe class='followGithub' src="https://ghbtns.com/github-btn.html?user=vict0rsch&type=follow&count=false&size=small"
                        frameborder="0" scrolling="0" width="220px" height="20px" align="top"></iframe>
                    
                </p>
                
            </address>

        </footer>

        
        <section>
            <!-- <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'http-vict0rsch-github-io'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script> -->

        </section>
        
    </div>
</article>
        </div>
    </div>

    <footer class="site-footer" id="footer">
        <div class="container" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 2.5rem">
            <div id="footer-subcontainer">
                <nav>
                    &copy; 2021
                    <!-- <a href=""></a> &middot; -->
                    <a href="/">Posts</a> &middot;
                    <a class="search-link" href="#">Search</a> &middot;
                    
                    <a href="/resources">Resources</a> &middot;
                    
                    
                    <a href="/about">About</a>
                    <span id="iframe-middot">
                        &middot;
                    </span>

                    
                    <div id="iframe-stars">
                        <iframe src="https://ghbtns.com/github-btn.html?user=vict0rsch&repo=deep_learning&type=star&count=true&size=small"
                            frameborder="0" scrolling="0" width="84px" height="20px" align="top"></iframe>
                    </div>
                </nav>
                <a class="brand" href="/" id="logo-footer">
                    <img src="/images/light-bulb.svg" alt="Home">
                </a>
            </div>
            <nav class="social" style="display: none">
                
                <!--<a href="https://twitter.com/vict0rsch" title="Follow on Twitter" target="_blank"><i class="icon icon-twitter black"></i></a> -->
                
                
                <!--<a href="/feed.xml" title="RSS Feed">
                <i class="icon icon-rss
                black"></i>
            </a> -->
            </nav>
        </div>
        <!-- <p style="text-align: center">Incorporated theme by <a href="https://sendtoinc.com">Inc</a></p> -->
    </footer>

    <script src="https://code.jquery.com/jquery-3.4.0.min.js"
  integrity="sha256-BJeo0qm959uMBGb65z40ejJYGSgR7REI4+CW1fNKwOg=" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/typeit@v6/dist/typeit.min.js" />

// <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.0/anchor.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.0/anchor.min.js"></script>


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

<script integrity="sha256-OtUha0k2/9UfGo5Gk1z/sd7U+h+D976k0yB92whsPW4=" crossorigin="anonymous" src="/assets/jquery.details.min-3ad5216b4936ffd51f1a8e46935cffb1ded4fa1f83f7bea4d3207ddb086c3d6e.js" type="text/javascript"></script>
<script integrity="sha256-4wzmvLQ/OBBCfxELN4DUGzj7PW+xnN7NlI0d//TQB18=" crossorigin="anonymous" src="/assets/main-e30ce6bcb43f3810427f110b3780d41b38fb3d6fb19cdecd948d1dfff4d0075f.js" type="text/javascript"></script>
<script integrity="sha256-onGmRDUJ8Zf39A1uJov1b9pZtNzd5TxySBgWLJF0VY4=" crossorigin="anonymous" src="/assets/tingle-a271a6443509f197f7f40d6e268bf56fda59b4dcdde53c724818162c9174558e.js" type="text/javascript"></script>
<script integrity="sha256-CfaxBGUjUvpFlFRKgjFuU0wjm8nOSRE6pEV3OnmjJIc=" crossorigin="anonymous" src="/assets/search-09f6b104652352fa4594544a82316e534c239bc9ce49113aa445773a79a32487.js" type="text/javascript"></script>
<script integrity="sha256-bcehUY3Ujb9kllPCKFSl6b1nP5+Be8VJ9/5tW9wOLyQ=" crossorigin="anonymous" src="/assets/resourceCards-6dc7a1518dd48dbf649653c22854a5e9bd673f9f817bc549f7fe6d5bdc0e2f24.js" type="text/javascript"></script>




<script>!function (d, s, id) { var js, fjs = d.getElementsByTagName(s)[0], p = /^http:/.test(d.location) ? 'http' : 'https'; if (!d.getElementById(id)) { js = d.createElement(s); js.id = id; js.src = p + '://platform.twitter.com/widgets.js'; fjs.parentNode.insertBefore(js, fjs); } }(document, 'script', 'twitter-wjs');</script>



<div id="fb-root"></div>
<script>(function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=253595308025739";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>








</body>

</html>
